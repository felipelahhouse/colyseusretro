<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste SNES Simples</title>
    <link rel="stylesheet" href="/emulatorjs/emulator.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }
        #game {
            width: 100vw;
            height: 100vh;
        }
        #info {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: #0ea5e9;
            padding: 20px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 12px;
            max-width: 400px;
            z-index: 9999;
        }
        .log {
            margin: 5px 0;
            padding: 5px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
        .warning { color: #f59e0b; }
    </style>
</head>
<body>
    <div id="info">
        <h3>üéÆ Teste SNES - Super Mario World</h3>
        <div id="logs"></div>
    </div>
    <div id="game"></div>

    <script>
        function log(message, type = 'info') {
            const logsDiv = document.getElementById('logs');
            const logEl = document.createElement('div');
            logEl.className = `log ${type}`;
            logEl.textContent = message;
            logsDiv.appendChild(logEl);
            console.log(`[${type.toUpperCase()}]`, message);
            
            // Auto-scroll
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        log('üöÄ Iniciando teste...', 'info');
        
        // Configura√ß√£o m√≠nima do EmulatorJS
        log('‚öôÔ∏è Configurando EmulatorJS...', 'info');
        
        window.EJS_player = '#game';
        window.EJS_core = 'snes9x';
        window.EJS_gameUrl = '/roms/snes/Super Mario World.sfc';
        window.EJS_gameName = 'Super Mario World';
        window.EJS_pathtodata = '/emulatorjs/';
        window.EJS_startOnLoaded = true;
        window.EJS_color = '#0ea5e9';
        
        log('‚úÖ Configura√ß√µes definidas:', 'success');
        log(`  - Core: ${window.EJS_core}`, 'info');
        log(`  - ROM: ${window.EJS_gameUrl}`, 'info');
        log(`  - Path: ${window.EJS_pathtodata}`, 'info');
        
        // Callbacks
        window.EJS_onGameStart = function() {
            log('‚úÖ‚úÖ‚úÖ JOGO INICIOU!', 'success');
            document.getElementById('info').style.display = 'none';
        };
        
        window.EJS_onError = function(error) {
            log('‚ùå ERRO: ' + error, 'error');
        };
        
        // Verifica se ROM √© acess√≠vel
        log('üîç Testando acesso √† ROM...', 'info');
        fetch(window.EJS_gameUrl, { method: 'HEAD' })
            .then(response => {
                if (response.ok) {
                    const size = response.headers.get('content-length');
                    log(`‚úÖ ROM acess√≠vel! Tamanho: ${(size/1024).toFixed(2)} KB`, 'success');
                } else {
                    log(`‚ö†Ô∏è ROM retornou status: ${response.status}`, 'warning');
                }
            })
            .catch(error => {
                log(`‚ö†Ô∏è Erro ao testar ROM: ${error.message}`, 'warning');
            });
        
        // Carrega o EmulatorJS
        log('üì• Carregando EmulatorJS...', 'info');
        const script = document.createElement('script');
        script.src = '/emulatorjs/loader.js';
        script.onload = () => {
            log('‚úÖ EmulatorJS carregado!', 'success');
            log('‚è≥ Aguardando inicializa√ß√£o do jogo...', 'info');
        };
        script.onerror = (error) => {
            log('‚ùå ERRO ao carregar EmulatorJS!', 'error');
            log('Verifique se /emulatorjs/loader.js existe', 'error');
        };
        document.body.appendChild(script);
        
        // Timeout de seguran√ßa
        setTimeout(() => {
            const logs = document.getElementById('logs');
            if (logs.textContent.includes('JOGO INICIOU')) {
                log('‚úÖ Teste conclu√≠do com sucesso!', 'success');
            } else {
                log('‚ö†Ô∏è Jogo ainda n√£o iniciou ap√≥s 30 segundos', 'warning');
                log('Verifique o console do navegador para mais detalhes', 'warning');
            }
        }, 30000);
    </script>
</body>
</html>
